
!
! Last configuration change at 12:36:13 UTC Wed May 11 2022 by admin
! NVRAM config last updated at 12:36:13 UTC Wed May 11 2022 by admin
!
version 16.12
no service pad
service timestamps debug datetime msec localtime
service timestamps log datetime msec localtime
service compress-config
! Call-home is enabled by Smart-Licensing.
service call-home
platform punt-keepalive disable-kernel-core
!
hostname c3850-lab
!
!
vrf definition Mgmt-vrf
 !
 address-family ipv4
 exit-address-family
 !
 address-family ipv6
 exit-address-family
!
enable secret 9 $14$N1fF$MmZMS9tsHDic0k$4GgaSe5nZbOBIWhK73xT.Uk3/glPHMLU24z8hGC5tX2
!
aaa new-model
!
!
aaa group server radius RADIUS-ISE
 server name RADIUS_usmfise02_3.45.249.208
!
aaa authentication login default local
aaa authentication dot1x default group RADIUS-ISE
aaa authorization config-commands
aaa authorization exec default group TACACS-ISE local if-authenticated 
aaa authorization network default group RADIUS-ISE 
aaa accounting update newinfo periodic 2880
aaa accounting identity default start-stop group RADIUS-ISE
!
!
!
!
!
aaa server radius dynamic-author
 client 3.45.249.208 server-key cisco
 auth-type any
!
aaa session-id common
boot system switch all flash:cat3k_caa-universalk9.16.12.07.SPA.bin
switch 1 provision ws-c3850-48p
!
!
!
!
call-home
 ! If contact email address in call-home is configured as sch-smart-licensing@cisco.com
 ! the email address configured in Cisco Smart License Portal will be used as contact email address to send SCH notifications.
 contact-email-addr sch-smart-licensing@cisco.com
 profile "CiscoTAC-1"
  active
  destination transport-method http
  no destination transport-method email
!
!
!
!
!
no ip domain lookup
ip domain name iem4.com
!
!
!
ip dhcp snooping vlan 1-1024
no ip dhcp snooping information option
ip dhcp snooping
login on-success log
!
!
!
!
!
!
device-sensor filter-list dhcp list sensor-dhcp-list
 option name host-name
 option name requested-address
 option name parameter-request-list
 option name class-identifier
 option name client-identifier
 option name user-class-id
!
device-sensor filter-list lldp list sensor-lldp-list
 tlv name system-name
 tlv name system-description
 tlv name system-capabilities
!
device-sensor filter-list cdp list sensor-cdp-list
 tlv name device-name
 tlv name address-type
 tlv name capabilities-type
 tlv name platform-type
device-sensor filter-spec dhcp include list sensor-dhcp-list
device-sensor filter-spec lldp include list sensor-lldp-list
device-sensor filter-spec cdp include list sensor-cdp-list
device-sensor notify all-changes
!
!
vtp domain iem4.com
vtp mode transparent
access-session attributes filter-list list access-session-list-auth
 vlan-id
access-session attributes filter-list list access-session-list-acct
 cdp
 lldp
 dhcp
access-session authentication attributes filter-spec include list access-session-list-auth
access-session accounting attributes filter-spec include list access-session-list-acct
access-session mac-move deny
no device-tracking logging theft
device-tracking tracking auto-source fallback 198.18.1.1 255.255.255.255 overri
!
device-tracking policy device-tracking-policy
 no protocol ndp
 no protocol dhcp6
 no protocol udp
 tracking enable
!
device-tracking policy device-tracking-uplink-policy
 trusted-port
 device-role switch
 no protocol udp
!
!
source template 1X_MAB
!
!
crypto pki trustpoint TP-self-signed-2906043205
 enrollment selfsigned
 subject-name cn=IOS-Self-Signed-Certificate-2906043205
 revocation-check none
 rsakeypair TP-self-signed-2906043205
!
crypto pki trustpoint SLA-TrustPoint
 enrollment pkcs12
 revocation-check crl
!
!
crypto pki certificate chain TP-self-signed-2906043205
 certificate self-signed 01 nvram:IOS-Self-Sig#3.cer
crypto pki certificate chain SLA-TrustPoint
 certificate ca 01 nvram:CiscoLicensi#1CA.cer
!
!
service-template DEFAULT_LINKSEC_POLICY_MUST_SECURE
 linksec policy must-secure
service-template DEFAULT_LINKSEC_POLICY_SHOULD_SECURE
 linksec policy should-secure
service-template DEFAULT_CRITICAL_VOICE_TEMPLATE
 voice vlan
service-template DEFAULT_CRITICAL_DATA_TEMPLATE
service-template webauth-global-inactive
 inactivity-timer 3600 
service-template CRITICAL_TEMPLATE
 access-group ACL-ISE-PERMIT-ANY
service-template CRITICAL_VOICE_TEMPLATE
 access-group ACL-ISE-PERMIT-ANY
 voice vlan
dot1x system-auth-control
dot1x critical eapol
license boot level ipservicesk9
!
!
diagnostic bootup level minimal
!
spanning-tree mode pvst
spanning-tree extend system-id
archive
 log config
  logging enable
 path ftp://3.45.249.203/configs/raw_configs/$h$t
 write-memory
 time-period 432000
memory free low-watermark processor 79468
!
username admin privilege 15 secret 9 $14$Y/.O$Obkg4au860Rc7k$SFiNG7um6ntzgqtIhkEpOrC5gXxBqmXK3xleEqkkzEI
!
redundancy
 mode sso
!
!
!
!
!
transceiver type all
 monitoring
!
hw-switch switch 1 logging onboard message
!
vlan configuration 1-1024
 device-tracking attach-policy device-tracking-policy
lldp run
!
class-map type control subscriber match-any AAA-DOWN-AUTH
 match authorization-status authorized
 match result-type aaa-timeout
!
class-map type control subscriber match-any AAA-DOWN-UNAUTH
 match authorization-status unauthorized
 match result-type aaa-timeout
!
class-map type control subscriber match-all DOT1X-FAILED
 match method dot1x
 match result-type method dot1x authoritative
!
class-map type control subscriber match-all DOT1X-NO-RESP
 match method dot1x
 match result-type method dot1x agent-not-found
!
class-map type control subscriber match-all DOT1X_TIMEOUT
 match method dot1x
 match result-type method-timeout
!
class-map type control subscriber match-all MAB-FAILED
 match method mab
 match result-type method mab authoritative
!
!
class-map match-any system-cpp-police-topology-control
  description Topology control
class-map match-any system-cpp-police-sw-forward
  description Sw forwarding, L2 LVX data, LOGGING
class-map match-any system-cpp-default
  description EWLC control, EWLC data, Inter FED 
class-map match-any system-cpp-police-sys-data
  description Learning cache ovfl, High Rate App, Exception, EGR Exception, NFL SAMPLED DATA, RPF Failed
class-map match-any system-cpp-police-punt-webauth
  description Punt Webauth
class-map match-any system-cpp-police-l2lvx-control
  description L2 LVX control packets
class-map match-any system-cpp-police-forus
  description Forus Address resolution and Forus traffic
class-map match-any system-cpp-police-multicast-end-station
  description MCAST END STATION
class-map match-any system-cpp-police-multicast
  description Transit Traffic and MCAST Data
class-map match-any system-cpp-police-l2-control
  description L2 control
class-map match-any system-cpp-police-dot1x-auth
  description DOT1X Auth
class-map match-any system-cpp-police-data
  description ICMP redirect, ICMP_GEN and BROADCAST
class-map match-any system-cpp-police-stackwise-virt-control
  description Stackwise Virtual
class-map match-any non-client-nrt-class
class-map match-any system-cpp-police-routing-control
  description Routing control and Low Latency
class-map match-any system-cpp-police-protocol-snooping
  description Protocol snooping
class-map match-any system-cpp-police-dhcp-snooping
  description DHCP snooping
class-map match-any system-cpp-police-system-critical
  description System Critical and Gold Pkt
!
policy-map type control subscriber DOT1X-DEFAULT
 event session-started match-all
  10 class always do-until-failure
   10 authenticate using dot1x priority 10
   20 authenticate using mab priority 20
 event violation match-all
  10 class always do-until-failure
   10 replace
 event agent-found match-all
  10 class always do-until-failure
   10 terminate mab
   20 authenticate using dot1x retries 2 retry-time 0 priority 10
 event inactivity-timeout match-all
  10 class always do-until-failure
   10 clear-session
 event authentication-failure match-first
  10 class DOT1X-FAILED do-until-failure
   10 terminate dot1x
   20 authenticate using mab priority 20
  20 class AAA-DOWN-UNAUTH do-until-failure
   10 activate service-template CRITICAL_TEMPLATE
   20 activate service-template CRITICAL_VOICE_TEMPLATE
   30 authorize
   40 pause reauthentication
  30 class AAA-DOWN-AUTH do-until-failure
   10 pause reauthentication
   20 authorize
  40 class DOT1X-NO-RESP do-until-failure
   10 terminate dot1x
   20 authenticate using mab priority 20
  50 class MAB-FAILED do-until-failure
   10 terminate mab
   20 authentication-restart 60
  60 class DOT1X_TIMEOUT do-until-failure
   10 terminate dot1x
   20 authenticate using mab priority 20
  70 class always do-until-failure
   10 terminate dot1x
   20 terminate mab
   30 authentication-restart 60
 event aaa-available match-all
  10 class always do-until-failure
   10 clear-session
!
policy-map type control subscriber PROFILE-ONLY
 event session-started match-all
  10 class always do-until-failure
   10 authorize
!
policy-map system-cpp-policy
policy-map port_child_policy
 class non-client-nrt-class
  bandwidth remaining ratio 10
!
! 
!
!
!
!
!
!
!
!
!
template 1X_MAB
 dot1x pae authenticator
 mab
 access-session port-control auto
 authentication periodic
 authentication timer reauthenticate server
 service-policy type control subscriber DOT1X-DEFAULT
!
!
interface GigabitEthernet0/0
 vrf forwarding Mgmt-vrf
 ip address 3.45.249.254 255.255.255.0
 negotiation auto
!
interface GigabitEthernet1/0/1
!
interface GigabitEthernet1/0/2
!
interface GigabitEthernet1/0/3
!
interface GigabitEthernet1/0/4
!
interface GigabitEthernet1/0/5
!
interface GigabitEthernet1/0/6
!
interface GigabitEthernet1/0/7
!
interface GigabitEthernet1/0/8
!
interface GigabitEthernet1/0/9
!
interface GigabitEthernet1/0/10
!
interface GigabitEthernet1/0/11
!
interface GigabitEthernet1/0/12
!
interface GigabitEthernet1/0/13
!
interface GigabitEthernet1/0/14
!
interface GigabitEthernet1/0/15
!
interface GigabitEthernet1/0/16
!
interface GigabitEthernet1/0/17
!
interface GigabitEthernet1/0/18
!
interface GigabitEthernet1/0/19
!
interface GigabitEthernet1/0/20
!
interface GigabitEthernet1/0/21
!
interface GigabitEthernet1/0/22
!
interface GigabitEthernet1/0/23
!
interface GigabitEthernet1/0/24
!
interface GigabitEthernet1/0/25
!
interface GigabitEthernet1/0/26
!
interface GigabitEthernet1/0/27
!
interface GigabitEthernet1/0/28
!
interface GigabitEthernet1/0/29
!
interface GigabitEthernet1/0/30
!
interface GigabitEthernet1/0/31
!
interface GigabitEthernet1/0/32
!
interface GigabitEthernet1/0/33
!
interface GigabitEthernet1/0/34
!
interface GigabitEthernet1/0/35
!
interface GigabitEthernet1/0/36
!
interface GigabitEthernet1/0/37
!
interface GigabitEthernet1/0/38
!
interface GigabitEthernet1/0/39
!
interface GigabitEthernet1/0/40
!
interface GigabitEthernet1/0/41
!
interface GigabitEthernet1/0/42
!
interface GigabitEthernet1/0/43
!
interface GigabitEthernet1/0/44
!
interface GigabitEthernet1/0/45
!
interface GigabitEthernet1/0/46
!
interface GigabitEthernet1/0/47
!
interface GigabitEthernet1/0/48
!
interface GigabitEthernet1/1/1
!
interface GigabitEthernet1/1/2
!
interface GigabitEthernet1/1/3
!
interface GigabitEthernet1/1/4
!
interface TenGigabitEthernet1/1/1
!
interface TenGigabitEthernet1/1/2
!
interface TenGigabitEthernet1/1/3
!
interface TenGigabitEthernet1/1/4
!
interface Vlan1
 no ip address
 shutdown
!
ip forward-protocol nd
ip http server
ip http authentication local
ip http secure-server
ip ftp source-interface GigabitEthernet0/0
ip ftp username cisco
ip ftp password anonymous
ip route vrf Mgmt-vrf 0.0.0.0 0.0.0.0 3.45.249.1
!
!
ip access-list extended ACL-ISE-DEFAULT
 10 permit udp any eq bootpc any eq bootps
 20 permit udp any any eq domain
 30 permit icmp any any
 40 permit udp any any eq tftp
 50 permit ip any host 3.45.249.208
 100 deny   ip any any
ip access-list extended ACL-ISE-PERMIT-ANY
 10 permit ip any any
ip access-list extended ACL-ISE-REDIRECT
 10 deny   udp any eq bootpc any eq bootps
 20 deny   udp any any eq domain
 30 deny   tcp any host 3.45.249.208 eq 8443
 50 permit ip any any
!
!
!
!
radius-server attribute 6 on-for-login-auth
radius-server attribute 6 support-multiple
radius-server attribute 8 include-in-access-req
radius-server attribute 25 access-request include
radius-server attribute 31 mac format ietf upper-case
radius-server attribute 31 send nas-port-detail mac-only
radius-server dead-criteria time 5 tries 3
radius-server deadtime 3
!
radius server RADIUS_usmfise02_3.45.249.208
 address ipv4 3.45.249.208 auth-port 1812 acct-port 1813
 automate-tester username radius-test ignore-acct-port probe-on
 key cisco.123
!
!
control-plane
 service-policy input system-cpp-policy
!
!
line con 0
 stopbits 1
line aux 0
 stopbits 1
line vty 5 15
!
ntp logging
ntp master 3
!
wsma agent exec
 profile httplistener
 profile httpslistener
!
wsma agent config
 profile httplistener
 profile httpslistener
!
wsma agent filesys
 profile httplistener
 profile httpslistener
!
wsma agent notify
 profile httplistener
 profile httpslistener
!
!
wsma profile listener httplistener
 transport http
!
wsma profile listener httpslistener
 transport https
!
end
